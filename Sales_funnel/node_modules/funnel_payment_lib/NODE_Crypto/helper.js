/**
 * Created by daulet on 8/23/16.
 */
var crypto = require("crypto");
var path = require("path");
var fs = require("fs");

module.exports = {

    Base64: {
        _encrypt: function (private_key_path, data) {
            var signer = crypto.createSign("RSA-SHA256");
            var prv_key = fs.readFileSync(path.resolve(private_key_path), "utf8")
            signer.update(data);
            var sign = signer.sign(prv_key, "base64");
            return (sign);
        },

        _verifySign: function (pub_key_path, sign, data) {
            var verifier = crypto.createVerify("RSA-SHA256");
            var pub_key = fs.readFileSync(path.resolve(pub_key_path), "utf8");
            verifier.update(data);
            var result = verifier.verify(pub_key, sign, 'base64');
            return (result);
        }
    }

};